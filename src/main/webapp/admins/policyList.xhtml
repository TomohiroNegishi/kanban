<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:jsf="http://xmlns.jcp.org/jsf">
    <ui:composition template="/loginTemplate.xhtml">
        <ui:define name="title">#{msgs['policyList']}#{msgs['sysName']}</ui:define>
        <ui:define name="header">
            <div class="page-header">
                <h3><h:outputText id ="pageTitle" value="#{msgs['policyList']}"/></h3>
            </div>
        </ui:define>
        <ui:define name="content">
            <h:form prependId="false">
                <div>
                    <h:commandLink id="backAdminMenu" style="margin-bottom: 20px;" class="btn btn-primary" action="#{policyListBean.backAdminMenuPage()}" value="#{msgs['backAdminMenuPage']}"/>
                </div>
                <div class="row">
                    <div class="col-sm-3 pulldown">
                        <h:selectOneMenu id="department" class="form-control" value="#{policyListBean.selectCode}">
                            <f:selectItems value="#{policyListBean.pulldownDepartmentList}" var="department" itemValue="#{department.code}" itemLabel="#{department.name}"/>  
                            <f:ajax event="change" onevent="timeoutAjax" render="policyTable" listener="#{policyListBean.changePulldown()}"/>
                        </h:selectOneMenu>
                    </div>
                </div>
                <div jsf:id="policyTable">
                    <ui:repeat id="policyGroupListModel" value="#{policyListBean.policyGroupListModel}" var="policyGroupListModel">
                        <ui:fragment rendered="#{policyGroupListModel.policyListModels.size()!=0}" >
                            <div class="panel panel-primary">
                                <div class="panel panel-heading">
                                    <h:outputText id="groupName" value="#{policyGroupListModel.name}"/>
                                </div>
                                <table class="table table-bordered table-condensed table-hover budgetListTable">
                                    <thead>
                                        <tr class="active">
                                            <th id="policyCodeHead" class="text-center policyCode">#{msgs['policyCode']}</th>
                                            <th id="policyNameHead" class="text-center policyName">#{msgs['policyName']}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ui:repeat id="policyListModel" value="#{policyGroupListModel.policyListModels}" var="policyListModel">
                                            <tr>
                                                <td>
                                                    <h:link id="policyCode" outcome="/admins/editPolicy.xhtml" value="#{policyListModel.policyCode}" class="link">
                                                        <f:param value="#{policyListModel.policyCode}" name="policyCode"/>
                                                        <f:param value="#{policyListBean.selectCode}" name="headquaterCode"/>
                                                    </h:link>
                                                </td>
                                                <td>
                                                    <h:outputText id="policyName" value="#{policyListModel.policyName}"/>
                                                </td>
                                            </tr>
                                        </ui:repeat>
                                    </tbody>
                                </table>
                            </div>
                        </ui:fragment>
                    </ui:repeat>
                </div>
            </h:form>
        </ui:define>
    </ui:composition>
</html>

